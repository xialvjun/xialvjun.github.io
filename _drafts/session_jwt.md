南宁-黄彩龙  10:35:44
浏览器支持了使用HTTPONLY来保护Cookie不被XSS攻击获取到。而目前localStorage存储没有对XSS攻击有任何抵御机制，一旦出现XSS漏洞，那么存储在localStorage里的数据就极易被获取到。
Sail-nodejs-广州  10:37:36
那sessionStorage呢？
北京-js-红瞳  10:48:42
那出现了 XSS 漏洞的话，黑客照样可以直接在用户的浏览器里调用接口啊
北京-js-红瞳  10:48:51
@南宁-黄彩龙 
南宁-黄彩龙  10:49:44
相对好点，至少用户能看见
北京-js-红瞳  10:50:16
https://segmentfault.com/q/1010000015330154
南宁-黄彩龙  10:50:42
假设黑客在不停的转钱，用户可以关浏览器，关电脑啊
北京-js-红瞳  10:50:46
刚才写完这个问题。。。写的过程中就发现了 refreshToken 的意义了。。。
北京-js-红瞳  10:51:04
[图片]
北京-js-红瞳  10:51:18
意义就是红框部分，提高黑客出错的代价
北京-js-红瞳  10:52:02
所以，最好的授权方式就是 cookie + session。。。。 cookie 里只存一个 session_id 。。。
北京-js-红瞳  10:52:26
呃，绕了一圈，又回到远古时代了
北京-js-红瞳  10:52:47
cookie 也是 httponly 和 secure 的
南宁-黄彩龙  10:53:15
@北京-js-红瞳 refresh token发送的次数少，可以防范中间人攻击
北京-js-红瞳  10:54:58
哦。。。就是 refreshToken 不只是一个接口，而是 既是接口，也是另一个 token 。。。登录的时候一共获得了两个 token
北京-js-红瞳  10:56:50
平时获取数据用 主 token。。。主 token 有  expireAt 。。。 客户端自己在主 token 快过期时自己用 refreshToken 调用 refreshToken 接口。。。refreshToken 没有 expireAt。。。是永久的。。。
北京-js-红瞳  10:57:54
或者 refreshToken 也有 expireAt。。。那就要有两个 接口了。。。调用 refreshToken 刷新 主 token。。。调用 refreshRefreshToken 刷新 refreshToken
北京-js-红瞳  10:58:54
我靠。。。这 jwt 这一套下来，想要保证安全性比 session 那一套麻烦多了。。。而且还不一定有 session 那一套安全。。。
南宁-黄彩龙  10:59:23
refreshToken 一般没有 expireAt了
北京-js-红瞳  11:00:58
其实也可以有啊，好处就是 如果命不好，被坏蛋拿到了 refreshToken，但我们可以祈求老子，让他让坏蛋一不小心，没有及时调用 refreshRefreshToken 啊
上海-TS-神楽坂花火  11:02:19
为什么我了解到的版本是refreshToken的过期时间比较长。。
南京-null  11:03:25
jwt  本身就不适合 做登陆授权
南京-null  11:03:50
jwt 更适合  做一次性的 票据授权
南京-null  11:03:56
给你之后 你只能用一次
南京-null  11:04:02
不然都有问题
南京-null  11:04:18
因为 jwt 的授权码 只要发出去了  你就无法剔除
南宁-黄彩龙  11:05:00
" 南京-null 11:04:18
因为 jwt 的授权码 只要发出去了  你就无法剔除 "
 可以剔除的，后台发现问题可以设置失效
广州-Elson  11:05:28
token有过期时间的
南京-null  11:05:39
这应该不是 jwt 本身具备的特性吧， 是你们通过其他方案解决的
南京-null  11:05:46
token  是有过期时间
南京-null  11:05:53
我们假设 过期时间是 30分钟
南京-null  11:06:00
你在第一分钟的时候 token 被人窃取了
南京-null  11:06:03
你也发现了
南京-null  11:06:09
然而你没有任何办法
南京-null  11:06:24
只能让别人用你的token  为所欲为  直到30分钟以后
广州-Elson  11:06:39
.......
南宁-黄彩龙  11:07:01
" 南京-null 11:06:03
你也发现了 "
 后端应该开发让后台管理员可以设置token失效的端口
南宁-黄彩龙  11:07:49
这个算是安全性功能，应该开发的
南京-null  11:07:57
我们不用jwt
南京-null  11:08:08
我们登陆之后 就简单的生成一个 uuid
南京-null  11:08:11
给前端
南京-null  11:08:36
这个uuid  可以 走一个接口 拿到用户数据，  每次请求的时候 都要带上
南京-null  11:09:43
jwt 的最大优势  其实就是 不需要存储机制
南京-null  11:09:46
直接就能用起来
南京-null  11:10:00
但是这样带来的弊端 就是 你无法剔除 失效的  token
南京-null  11:10:15
想能够剔除   就必须要存储机制  来设定  黑白名单
南宁-黄彩龙  11:10:40
@北京-js-红瞳 refreshToken不是必须的，上了https的话，可以不用它了
北京-js-红瞳  11:11:29
对。。。 refreshToken 只是 防 中间人，而 https 就彻底防了 中间人了
南宁-黄彩龙  11:11:39
@北京-js-红瞳 https都被攻破了的话，上refreshToken也没屌用
上海-TS-神楽坂花火  11:11:51
HTTPS怎么攻破..
北京-js-红瞳  11:12:18
用户枉顾浏览器左上角的 不安全提示
南宁-黄彩龙  11:12:20
https://blog.csdn.net/hbdatouerzi/article/details/71440206
南宁-黄彩龙  11:13:00
可以，但是很难。关键是，还要用户傻逼的去信任第三方证书才行
西安-nest-本初  11:13:39
这个基本上没用
西安-nest-本初  11:13:45
除非是网吧
西安-nest-本初  11:13:52
或者客户端已经内置了你的证书
西安-nest-本初  11:14:01
而且网吧还得是你的
南宁-黄彩龙  11:14:05
" 北京-js-红瞳 11:12:18
用户枉顾浏览器左上角的 不安全提示 "
 浏览器要用户手动点击信任，才会信任第三方证书
